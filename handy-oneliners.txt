# Find all json data files with errors in them, and return their path, contents and activity_id
find data -name '*.json' | xargs -L1 grep -l '"error":'|ghead -n "-1"|xargs -L1 bash -c 'echo $0 && cat $0 && $(echo $0 | ggrep -oP "data/gplus/activities/\K([^/]+)")'

# Find all json data files with empty item lists in them, and return their path, contents and activity_id
find data -name '*.json' | xargs -L1 grep -l '"items": \[\]'|ghead -n "-1"|xargs -L1 bash -c 'echo $0 && cat $0 && $(echo $0 | ggrep -oP "data/gplus/activities/\K([^/]+)")'

#Find all zero-byte data files:
find data -size 0

# Export first 20 comments in a combined JSON Blogger G+ Comments export file to HTML
cat archived-data-trilemma-2019-03-04/output/blog.trilemma.com.json | jq -cr '[[.blog .posts[] |select(.|keys|any(. == "activities")) | .activities[] | .object .replies | select(.|keys|any(. == "comments"))|.comments[]|.items]]|flatten[range(20)]|@base64'|gxargs -I@@ bin/generate-template-from-comment.sh templates/h-entry-p-comment-microformat.template.html templates/h-entry-author.template.html @@ > tmp-comments-body.html && bin/generate-html-template-layout.sh "default" "tmp-comments-body.html" > tmp-comments.html

# Export all comments in a combined JSON Blogger G+ Comments export file to HTML
cat archived-data-trilemma-2019-03-04/output/blog.trilemma.com.json | jq -cr '[[.blog .posts[] |select(.|keys|any(. == "activities")) | .activities[] | .object .replies | select(.|keys|any(. == "comments"))|.comments[]|.items]]|flatten[]|@base64'|gxargs -I@@ bin/generate-template-from-comment.sh templates/h-entry-p-comment-microformat.template.html templates/h-entry-author.template.html @@ > tmp-comments-body.html && bin/generate-html-template-layout.sh "default" "tmp-comments-body.html" > tmp-comments.html
